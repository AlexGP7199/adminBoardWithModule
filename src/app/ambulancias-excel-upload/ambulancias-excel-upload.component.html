<div class="max-w-4xl mx-auto bg-white rounded-lg shadow-lg p-6 mt-10">
  <h2 class="text-2xl font-semibold text-gray-800 mb-6">Importar Ambulancias desde Excel</h2>

  <!-- Input para cargar archivo -->
  <div class="mb-4">
    <label class="block text-sm font-medium text-gray-700">Subir Archivo Excel</label>
    <input
      type="file"
      (change)="onFileChange($event)"
      accept=".xlsx, .xls"
      class="form-input mt-1 block w-full rounded-lg border-gray-300 shadow-sm"
    />
  </div>

  <!-- Tabla de Previsualización -->
  <div *ngIf="data.length > 0" class="overflow-x-auto mt-6">
    <h3 class="text-lg font-semibold text-gray-700 mb-4">Previsualización de Datos</h3>
    <table class="w-full text-sm text-left text-gray-700 shadow-md rounded-lg">
      <thead class="text-xs text-gray-700 uppercase bg-gray-100">
        <tr>
          <th class="px-4 py-3">Región</th>
          <th class="px-4 py-3">Provincia</th>
          <th class="px-4 py-3">Código de la Preposición</th>
          <th class="px-4 py-3">Base Operativa</th>
          <th class="px-4 py-3">Georeferencia</th>
          <th class="px-4 py-3">Descripción</th>
          <th class="px-4 py-3">Tipo</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let row of data" class="bg-white border-b hover:bg-gray-50">
          <td class="px-4 py-3">{{ row['Región'] }}</td>
          <td class="px-4 py-3">{{ row['Provincia'] }}</td>
          <td class="px-4 py-3">{{ row['Codigo de la Preposición'] }}</td>
          <td class="px-4 py-3">{{ row['Base Operativa'] || 'SIN BASE OPERATIVA DESCRITA' }}</td>
          <td class="px-4 py-3">{{ row['Georeferencia'] }}</td>
          <td class="px-4 py-3">{{ row['Descripcion'] || 'SIN DESCRIPCIÓN' }}</td>
          <td class="px-4 py-3">{{ obtenerNombreTipo(row['Codigo de la Preposición']) }}</td>
        </tr>
      </tbody>
    </table>
  </div>

  <!-- Botón para procesar -->
  <div class="text-right mt-4">
    <button
      (click)="procesarDatos()"
      class="inline-flex items-center px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-lg shadow hover:bg-blue-700 focus:outline-none"
    >
      Procesar Datos
    </button>
  </div>
</div>
